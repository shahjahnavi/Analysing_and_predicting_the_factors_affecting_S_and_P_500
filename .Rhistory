data_industrials_2020 = subset(industrials, subset=industrials$Date>='2020-01-01' & industrials$Date<='2020-12-31')
data_industrials_2021 = subset(industrials, subset=industrials$Date>='2021-01-01' & industrials$Date<='2021-12-31')
data_industrials_2022 = subset(industrials, subset=industrials$Date>='2022-01-01' & industrials$Date<='2022-12-31')
Information_Technology$Date <- as.POSIXct( Information_Technology$Date, format="%Y-%m-%d" )
Information_Technology <- Information_Technology %>% mutate(month=month(Date))
Information_Technology <- Information_Technology %>% mutate(year=year(Date))
Information_Technology_month <- Information_Technology %>% group_by(month, year) %>% summarise(max_mean_close = sum(mean_close))
data_Information_Technology_2019 =subset(Information_Technology, subset=Information_Technology$Date>='2019-01-01' & Information_Technology$Date<='2019-12-31')
data_Information_Technology_2020 =subset(Information_Technology, subset=Information_Technology$Date>='2020-01-01' & Information_Technology$Date<='2020-12-31')
data_Information_Technology_2021 =subset(Information_Technology, subset=Information_Technology$Date>='2021-01-01' & Information_Technology$Date<='2021-12-31')
data_Information_Technology_2022 =subset(Information_Technology, subset=Information_Technology$Date>='2022-01-01' & Information_Technology$Date<='2022-12-31')
materials$Date <- as.POSIXct( materials$Date, format="%Y-%m-%d" )
materials <- materials %>% mutate(month=month(Date))
materials <- materials %>% mutate(year=year(Date))
materials_month <- materials %>% group_by(month, year) %>% summarise(max_mean_close = sum(mean_close))
data_materials_2019 = subset(materials, subset=materials$Date>='2019-01-01' & materials$Date<='2019-12-31')
data_materials_2020 = subset(materials, subset=materials$Date>='2020-01-01' & materials$Date<='2020-12-31')
data_materials_2021 = subset(materials, subset=materials$Date>='2021-01-01' & materials$Date<='2021-12-31')
data_materials_2022 = subset(materials, subset=materials$Date>='2022-01-01' & materials$Date<='2022-12-31')
real_estate$Date <- as.POSIXct( real_estate$Date, format="%Y-%m-%d" )
real_estate <- real_estate %>% mutate(month=month(Date))
real_estate <- real_estate %>% mutate(year=year(Date))
real_estate_month <- real_estate %>% group_by(month, year) %>% summarise(max_mean_close = sum(mean_close))
data_real_estate_2019 = subset(real_estate, subset=real_estate$Date>='2019-01-01' & real_estate$Date<='2019-12-31')
data_real_estate_2020 = subset(real_estate, subset=real_estate$Date>='2020-01-01' & real_estate$Date<='2020-12-31')
data_real_estate_2021 = subset(real_estate, subset=real_estate$Date>='2021-01-01' & real_estate$Date<='2021-12-31')
data_real_estate_2022 = subset(real_estate, subset=real_estate$Date>='2022-01-01' & real_estate$Date<='2022-12-31')
utilities$Date <- as.POSIXct( utilities$Date, format="%Y-%m-%d" )
utilities <- utilities %>% mutate(month=month(Date))
utilities <- utilities %>% mutate(year=year(Date))
utilities_month <- utilities %>% group_by(month, year) %>% summarise(max_mean_close = sum(mean_close))
data_utilities_2019 = subset(utilities, subset=utilities$Date>='2019-01-01' & utilities$Date<='2019-12-31')
data_utilities_2020 = subset(utilities, subset=utilities$Date>='2020-01-01' & utilities$Date<='2020-12-31')
data_utilities_2021 = subset(utilities, subset=utilities$Date>='2021-01-01' & utilities$Date<='2021-12-31')
data_utilities_2022 = subset(utilities, subset=utilities$Date>='2022-01-01' & utilities$Date<='2022-12-31')
head(data_communication_services_2019)
plot(10*diff(log(communication_services[,6])), xlab="year", ylab="mean_close", type="l", lwd=2, col="orange", ylim=c(-2,2), main="Closing Trend - Communication Services (log Values")
ggplot(data = data_communication_services_2019, aes(x = Date)) +
geom_line(linetype = "solid", size = 1, data=data_communication_services_2019, aes(y=mean_high), color='steelblue') +
geom_line(linetype = "solid", size = 1, data=data_communication_services_2020, aes(y=mean_high), color='coral2') +
geom_line(linetype = "solid", size = 1, data=data_communication_services_2021, aes(y=mean_high), color='darkorchid') +
geom_line(linetype = "solid", size = 1, data=data_communication_services_2022, aes(y=mean_high), color='darkorange')  + theme_minimal(base_size = 12) +
labs(title = " High Trend (normalised) - Communication Services", subtitle = "A line plot defining the high values for the Communication Services Sector (2019-22)", y = "High Trend", x = "Date")
ggplot(data = data_consumer_discretionary_2019, aes(x = Date)) +
geom_line(linetype = "solid", size = 1, data=data_consumer_discretionary_2019, aes(y=mean_high), color='steelblue') +
geom_line(linetype = "solid", size = 1, data=data_consumer_discretionary_2020, aes(y=mean_high), color='coral2') +
geom_line(linetype = "solid", size = 1, data=data_consumer_discretionary_2021, aes(y=mean_high), color='darkorchid') +
geom_line(linetype = "solid", size = 1, data=data_consumer_discretionary_2022, aes(y=mean_high), color='darkorange')  + theme_minimal(base_size = 12) +
labs(title = " High Trend (normalised) - Consumer Discretionary", subtitle = "A line plot defining the high values for the Consumer Discretionary Sector (2019-22)", y = "High Trend", x = "Date")
ggplot(data = data_financials_2019, aes(x = Date)) +
geom_line(linetype = "solid", size = 1, data=data_financials_2019, aes(y=mean_high), color='steelblue') +
geom_line(linetype = "solid", size = 1, data=data_financials_2020, aes(y=mean_high), color='coral2') +
geom_line(linetype = "solid", size = 1, data=data_financials_2021, aes(y=mean_high), color='darkorchid') +
geom_line(linetype = "solid", size = 1, data=data_financials_2022, aes(y=mean_high), color='darkorange')  + theme_minimal(base_size = 12) +  labs(title = " High Trend (normalised) - Financials", subtitle = "A line plot defining the high values for the Financials Sector (2019-22)", y = "High Trend", x = "Date")
ggplot(data = data_consumer_staples_2019, aes(x = Date)) +
geom_line(linetype = "solid", size = 1, data=data_consumer_staples_2019, aes(y=mean_high), color='steelblue') +
geom_line(linetype = "solid", size = 1, data=data_consumer_staples_2020, aes(y=mean_high), color='coral2') +
geom_line(linetype = "solid", size = 1, data=data_consumer_staples_2021, aes(y=mean_high), color='darkorchid') +
geom_line(linetype = "solid", size = 1, data=data_consumer_staples_2022, aes(y=mean_high), color='darkorange')  + theme_minimal(base_size = 12) +  labs(title = " High Trend (normalised) - Consumer Staples", subtitle = "A line plot defining the high values for the Consumer Staples Sector (2019-22)", y = "High Trend", x = "Date")
ggplot(data = data_energy_2019, aes(x = Date)) +
geom_line(linetype = "solid", size = 1, data=data_energy_2019, aes(y=mean_high), color='steelblue') +
geom_line(linetype = "solid", size = 1, data=data_energy_2020, aes(y=mean_high), color='coral2') +
geom_line(linetype = "solid", size = 1, data=data_energy_2021, aes(y=mean_high), color='darkorchid') +
geom_line(linetype = "solid", size = 1, data=data_energy_2022, aes(y=mean_high), color='darkorange')  + theme_minimal(base_size = 12)+ labs(title = " High Trend (normalised) - Energy", subtitle = "A line plot defining the high values for the Energy Sector (2019-22)", y = "High Trend", x = "Date")
ggplot(data = data_health_care_2019, aes(x = Date)) +
geom_line(linetype = "solid", size = 1, data=data_health_care_2019, aes(y=mean_high), color='steelblue') +
geom_line(linetype = "solid", size = 1, data=data_health_care_2020, aes(y=mean_high), color='coral2') +
geom_line(linetype = "solid", size = 1, data=data_health_care_2021, aes(y=mean_high), color='darkorchid') +
geom_line(linetype = "solid", size = 1, data=data_health_care_2022, aes(y=mean_high), color='darkorange')  + theme_minimal(base_size = 12) +  labs(title = " High Trend (normalised) - Health Care", subtitle = "A line plot defining the high values for the Health Care Sector (2019-22)", y = "High Trend", x = "Date")
ggplot(data = data_industrials_2019, aes(x = Date)) +
geom_line(linetype = "solid", size = 1, data=data_industrials_2019, aes(y=mean_high), color='steelblue') +
geom_line(linetype = "solid", size = 1, data=data_industrials_2020, aes(y=mean_high), color='coral2') +
geom_line(linetype = "solid", size = 1, data=data_industrials_2021, aes(y=mean_high), color='darkorchid') +
geom_line(linetype = "solid", size = 1, data=data_industrials_2022, aes(y=mean_high), color='darkorange')  + theme_minimal(base_size = 12) +  labs(title = " High Trend (normalised) - Industrials", subtitle = "A line plot defining the high values for the Industrial Sector (2019-22)", y = "High Trend", x = "Date")
ggplot(data = data_Information_Technology_2019, aes(x = Date)) +
geom_line(linetype = "solid", size = 1, data=data_Information_Technology_2019, aes(y=mean_high), color='steelblue') +
geom_line(linetype = "solid", size = 1, data=data_Information_Technology_2020, aes(y=mean_high), color='coral2') +
geom_line(linetype = "solid", size = 1, data=data_Information_Technology_2021, aes(y=mean_high), color='darkorchid') +
geom_line(linetype = "solid", size = 1, data=data_Information_Technology_2022, aes(y=mean_high), color='darkorange')  + theme_minimal(base_size = 12) +  labs(title = " High Trend (normalised) - Information Technology", subtitle = "A line plot defining the high values for the Information Technology Sector (2019-22)", y = "High Trend", x = "Date")
ggplot(data = data_materials_2019, aes(x = Date)) +
geom_line(linetype = "solid", size = 1, data=data_materials_2019, aes(y=mean_high), color='steelblue') +
geom_line(linetype = "solid", size = 1, data=data_materials_2020, aes(y=mean_high), color='coral2') +
geom_line(linetype = "solid", size = 1, data=data_materials_2021, aes(y=mean_high), color='darkorchid') +
geom_line(linetype = "solid", size = 1, data=data_materials_2022, aes(y=mean_high), color='darkorange')  + theme_minimal(base_size = 12) +  labs(title = " High Trend (normalised) - Materials", subtitle = "A line plot defining the high values for the Materials Sector (2019-22)", y = "High Trend", x = "Date")
ggplot(data = data_real_estate_2019, aes(x = Date)) +
geom_line(linetype = "solid", size = 1, data=data_real_estate_2019, aes(y=mean_high), color='steelblue') +
geom_line(linetype = "solid", size = 1, data=data_real_estate_2020, aes(y=mean_high), color='coral2') +
geom_line(linetype = "solid", size = 1, data=data_real_estate_2021, aes(y=mean_high), color='darkorchid') +
geom_line(linetype = "solid", size = 1, data=data_real_estate_2022, aes(y=mean_high), color='darkorange')  + theme_minimal(base_size = 12) +  labs(title = " High Trend (normalised) - Real Estate", subtitle = "A line plot defining the high values for the Real Estate Sector (2019-22)", y = "High Trend", x = "Date")
ggplot(data = data_utilities_2019, aes(x = Date)) +
geom_line(linetype = "solid", size = 1, data=data_utilities_2019, aes(y=mean_high), color='steelblue') +
geom_line(linetype = "solid", size = 1, data=data_utilities_2020, aes(y=mean_high), color='coral2') +
geom_line(linetype = "solid", size = 1, data=data_utilities_2021, aes(y=mean_high), color='darkorchid') +
geom_line(linetype = "solid", size = 1, data=data_utilities_2022, aes(y=mean_high), color='darkorange')  + theme_minimal(base_size = 12) +  labs(title = " High Trend (normalised) - Utilities", subtitle = "A line plot defining the high values for the Utilities Sector (2019-22)", y = "High Trend", x = "Date")
ggplot(data=communication_services, aes(group = 1, x = year)) +
geom_boxplot(linetype = "solid", size = 1, data=data_communication_services_2019, aes(y=mean_close), color='steelblue') +
geom_boxplot(linetype = "solid", size = 1, data=data_communication_services_2020, aes(y=mean_close), color='coral2') +
geom_boxplot(linetype = "solid", size = 1, data=data_communication_services_2021, aes(y=mean_close), color='darkorchid') +
geom_boxplot(linetype = "solid", size = 1, data=data_communication_services_2022, aes(y=mean_close), color='darkorange')  + theme_minimal(base_size = 12) +  labs(title = " Close Trend (normalised) - Communication Services", subtitle = "A box plot defining the close values for the Communication Services Sector (2019-22)", y = "Close Trend", x = "Date")
ggplot(data=consumer_discretionary, aes(group = 1, x = year)) +
geom_boxplot(linetype = "solid", size = 1, data=data_consumer_discretionary_2019, aes(y=mean_close), color='steelblue') +
geom_boxplot(linetype = "solid", size = 1, data=data_consumer_discretionary_2020, aes(y=mean_close), color='coral2') +
geom_boxplot(linetype = "solid", size = 1, data=data_consumer_discretionary_2021, aes(y=mean_close), color='darkorchid') +
geom_boxplot(linetype = "solid", size = 1, data=data_consumer_discretionary_2022, aes(y=mean_close), color='darkorange')  + theme_minimal(base_size = 12) + labs(title = " Close Trend (normalised) - Consumer Discretionary", subtitle = "A box plot defining the close values for the Consumer Discretionary Sector (2019-22)", y = "Close Trend", x = "Date")
ggplot(data=consumer_staples, aes(group = 1, x = year)) +
geom_boxplot(linetype = "solid", size = 1, data=data_consumer_staples_2019, aes(y=mean_close), color='steelblue') +
geom_boxplot(linetype = "solid", size = 1, data=data_consumer_staples_2020, aes(y=mean_close), color='coral2') +
geom_boxplot(linetype = "solid", size = 1, data=data_consumer_staples_2021, aes(y=mean_close), color='darkorchid') +
geom_boxplot(linetype = "solid", size = 1, data=data_consumer_staples_2022, aes(y=mean_close), color='darkorange')  + theme_minimal(base_size = 12) + labs(title = " Close Trend (normalised) - Consumer Staples", subtitle = "A box plot defining the close values for the Consumer Staples Sector (2019-22)", y = "Close Trend", x = "Date")
ggplot(data=energy, aes(group = 1, x = year)) +
geom_boxplot(linetype = "solid", size = 1, data=data_energy_2019, aes(y=mean_close), color='steelblue') +
geom_boxplot(linetype = "solid", size = 1, data=data_energy_2020, aes(y=mean_close), color='coral2') +
geom_boxplot(linetype = "solid", size = 1, data=data_energy_2021, aes(y=mean_close), color='darkorchid') +
geom_boxplot(linetype = "solid", size = 1, data=data_energy_2022, aes(y=mean_close), color='darkorange')  + theme_minimal(base_size = 12) + labs(title = " Close Trend (normalised) - Energy ", subtitle = "A box plot defining the close values for the Energy Sector (2019-22)", y = "Close Trend", x = "Date")
ggplot(data=financials, aes(group = 1, x = year)) +
geom_boxplot(linetype = "solid", size = 1, data=data_financials_2019, aes(y=mean_close), color='steelblue') +
geom_boxplot(linetype = "solid", size = 1, data=data_financials_2020, aes(y=mean_close), color='coral2') +
geom_boxplot(linetype = "solid", size = 1, data=data_financials_2021, aes(y=mean_close), color='darkorchid') +
geom_boxplot(linetype = "solid", size = 1, data=data_financials_2022, aes(y=mean_close), color='darkorange')  + theme_minimal(base_size = 12) + labs(title = " Close Trend (normalised) - Financials", subtitle = "A box plot defining the close values for the Financial Sector (2019-22)", y = "Close Trend", x = "Date")
ggplot(data=health_care, aes(group = 1, x = year)) +
geom_boxplot(linetype = "solid", size = 1, data=data_real_estate_2019, aes(y=mean_close), color='steelblue') +
geom_boxplot(linetype = "solid", size = 1, data=data_real_estate_2020, aes(y=mean_close), color='coral2') +
geom_boxplot(linetype = "solid", size = 1, data=data_real_estate_2021, aes(y=mean_close), color='darkorchid') +
geom_boxplot(linetype = "solid", size = 1, data=data_real_estate_2022, aes(y=mean_close), color='darkorange')  + theme_minimal(base_size = 12) + labs(title = " Close Trend (normalised) - Health Care", subtitle = "A box plot defining the close values for the Health Care Sector (2019-22)", y = "Close Trend", x = "Date")
ggplot(data=industrials, aes(group = 1, x = year)) +
geom_boxplot(linetype = "solid", size = 1, data=data_industrials_2019, aes(y=mean_close), color='steelblue') +
geom_boxplot(linetype = "solid", size = 1, data=data_industrials_2020, aes(y=mean_close), color='coral2') +
geom_boxplot(linetype = "solid", size = 1, data=data_industrials_2021, aes(y=mean_close), color='darkorchid') +
geom_boxplot(linetype = "solid", size = 1, data=data_industrials_2022, aes(y=mean_close), color='darkorange')  + theme_minimal(base_size = 12) + labs(title = " Close Trend (normalised) - Industrials", subtitle = "A box plot defining the close values for the Industrial Sector (2019-22)", y = "Close Trend", x = "Date")
ggplot(data=Information_Technology, aes(group = 1, x = year)) +
geom_boxplot(linetype = "solid", size = 1, data=data_Information_Technology_2019, aes(y=mean_close), color='steelblue') +
geom_boxplot(linetype = "solid", size = 1, data=data_Information_Technology_2020, aes(y=mean_close), color='coral2') +
geom_boxplot(linetype = "solid", size = 1, data=data_Information_Technology_2021, aes(y=mean_close), color='darkorchid') +
geom_boxplot(linetype = "solid", size = 1, data=data_Information_Technology_2022, aes(y=mean_close), color='darkorange')  + theme_minimal(base_size = 12) + labs(title = " Close Trend (normalised) - Informtion Technology ", subtitle = "A box plot defining the close values for the Information Technology Sector (2019-22)", y = "Close Trend", x = "Date")
ggplot(data=materials, aes(group = 1, x = year)) +
geom_boxplot(linetype = "solid", size = 1, data=data_materials_2019, aes(y=mean_close), color='steelblue') +
geom_boxplot(linetype = "solid", size = 1, data=data_materials_2020, aes(y=mean_close), color='coral2') +
geom_boxplot(linetype = "solid", size = 1, data=data_materials_2021, aes(y=mean_close), color='darkorchid') +
geom_boxplot(linetype = "solid", size = 1, data=data_materials_2022, aes(y=mean_close), color='darkorange')  + theme_minimal(base_size = 12) + labs(title = " Close Trend (normalised) - Materials", subtitle = "A box plot defining the close values for the Material Sector (2019-22)", y = "Close Trend", x = "Date")
ggplot(data=real_estate, aes(group = 1, x = year)) +
geom_boxplot(linetype = "solid", size = 1, data=data_real_estate_2019, aes(y=mean_close), color='steelblue') +
geom_boxplot(linetype = "solid", size = 1, data=data_real_estate_2020, aes(y=mean_close), color='coral2') +
geom_boxplot(linetype = "solid", size = 1, data=data_real_estate_2021, aes(y=mean_close), color='darkorchid') +
geom_boxplot(linetype = "solid", size = 1, data=data_real_estate_2022, aes(y=mean_close), color='darkorange')  + theme_minimal(base_size = 12) + labs(title = " Close Trend (normalised) - Real Estate ", subtitle = "A box plot defining the close values for the Real Estate Sector (2019-22)", y = "Close Trend", x = "Date")
ggplot(data=utilities, aes(group = 1, x = year)) +
geom_boxplot(linetype = "solid", size = 1, data=data_utilities_2019, aes(y=mean_close), color='steelblue') +
geom_boxplot(linetype = "solid", size = 1, data=data_utilities_2020, aes(y=mean_close), color='coral2') +
geom_boxplot(linetype = "solid", size = 1, data=data_utilities_2021, aes(y=mean_close), color='darkorchid') +
geom_boxplot(linetype = "solid", size = 1, data=data_utilities_2022, aes(y=mean_close), color='darkorange')  + theme_minimal(base_size = 12) + labs(title = " Close Trend (normalised) - Utilities", subtitle = "A box plot defining the close values for the Utilities (2019-22)", y = "Close Trend", x = "Date")
ggplot(data=communication_services) +
geom_line(linetype = "solid", size = 1, aes(x=Date, y=mean_high), color='darkorchid') +
geom_line(linetype = "solid", size = 1, aes(x=Date, y=mean_low), color='darkorange')  + theme_minimal(base_size = 12) +
labs(title = "High and Low Trend - Communication Services", subtitle = "A line plot defining the high and low values for the Communication Services Sector (2019-22)", y = "High (Purple) and Low (Orange) Trend", x = "Date")
ggplot(data=consumer_discretionary) +
geom_line(linetype = "solid", size = 1, aes(x=Date, y=mean_high), color='darkorchid') +
geom_line(linetype = "solid", size = 1, aes(x=Date, y=mean_low), color='darkorange')  + theme_minimal(base_size = 12) +
labs(title = "High and Low Trend - Consumer Discretionary", subtitle = "A line plot defining the high and low values for the Consumer Discretionary Sector(2019-22)", y = "High(Purple) and low(Orange)Trend", x = "Date")
ggplot(data=consumer_staples) +
geom_line(linetype = "solid", size = 1, aes(x=Date, y=mean_high), color='darkorchid') +
geom_line(linetype = "solid", size = 1, aes(x=Date, y=mean_low), color='darkorange')  + theme_minimal(base_size = 12) +
labs(title = "High and Low Trend - Consumer Staples", subtitle = "A line plot defining the high and low values for the Consumer Staples Sector (2019-22)", y = "High(Pruple) and low(Orange)Trend", x = "Date")
ggplot(data=energy) +
geom_line(linetype = "solid", size = 1, aes(x=Date, y=mean_high), color='darkorchid') +
geom_line(linetype = "solid", size = 1, aes(x=Date, y=mean_low), color='darkorange')  + theme_minimal(base_size = 12) +
labs(title = "High and Low Trend - Energy", subtitle = "A line plot defining the high and low values for the Energy Sector (2019-22)", y = "High(Purple) and low(Orange) Trend", x = "Date")
ggplot(data=financials) +
geom_line(linetype = "solid", size = 1, aes(x=Date, y=mean_high), color='darkorchid') +
geom_line(linetype = "solid", size = 1, aes(x=Date, y=mean_low), color='darkorange')  + theme_minimal(base_size = 12) +
labs(title = "High and Low Trend - Financial", subtitle = "A line plot defining the high and low values for the Financial Sector (2019-22)", y = "High(Purple) and low(Orange)Trend", x = "Date")
ggplot(data=health_care) +
geom_line(linetype = "solid", size = 1, aes(x=Date, y=mean_high), color='darkorchid') +
geom_line(linetype = "solid", size = 1, aes(x=Date, y=mean_low), color='darkorange')  + theme_minimal(base_size = 12) +
labs(title = "High and Low Trend - Health Care", subtitle = "A scatter plot defining the high and low values for the Health Care Sector (2019-22)", y = "High(Purple) and low(Orange)Trend", x = "Date")
ggplot(data=industrials) +
geom_line(linetype = "solid", size = 1, aes(x=Date, y=mean_high), color='darkorchid') +
geom_line(linetype = "solid", size = 1, aes(x=Date, y=mean_low), color='darkorange')  + theme_minimal(base_size = 12) +
labs(title = "High and Low Trend - Industrial", subtitle = "A line plot defining the high and low values for the Industrial Sector (2019-22)", y = "High(Purple) and low(Orange)Trend", x = "Date")
ggplot(data=Information_Technology) +
geom_line(linetype = "solid", size = 1, aes(x=Date, y=mean_high), color='darkorchid') +
geom_line(linetype = "solid", size = 1, aes(x=Date, y=mean_low), color='darkorange')  + theme_minimal(base_size = 12) +
labs(title = "High and Low Trend - Information Technology", subtitle = "A line plot defining the high and low values for the Information Technology Sector (2019-22)", y = "High(Purple) and Low(Orange)Trend", x = "Date")
ggplot(data=materials) +
geom_line(linetype = "solid", size = 1, aes(x=Date, y=mean_high), color='darkorchid') +
geom_line(linetype = "solid", size = 1, aes(x=Date, y=mean_low), color='darkorange')  + theme_minimal(base_size = 12) +
labs(title = "High and Low Trend - Materials", subtitle = "A line plot defining the high and low values for the Material Sector (2019-22)", y = "High(Purple) and Low(Orange)Trend", x = "Date")
ggplot(data=real_estate) +
geom_line(linetype = "solid", size = 1, aes(x=Date, y=mean_high), color='darkorchid') +
geom_line(linetype = "solid", size = 1, aes(x=Date, y=mean_low), color='darkorange')  + theme_minimal(base_size = 12) +
labs(title = "High and Low Trend - Real Estate", subtitle = "A line plot defining the close values for the Real Estate Sector(2019-22)", y = "High(Purple) and Low(Orange)Trend", x = "Date")
ggplot(data=utilities) +
geom_line(linetype = "solid", size = 1, aes(x=Date, y=mean_high), color='darkorchid') +
geom_line(linetype = "solid", size = 1, aes(x=Date, y=mean_low), color='darkorange')  + theme_minimal(base_size = 12) +
labs(title = "High and Low Trend - Utilities", subtitle = "A line plot defining the high and low values for the Utility Sector (2019-22)", y = "High(Purple) and Low(Orange)Trend", x = "Date")
communication_services %>%
ggplot(aes(x = month, y = mean_high)) +
geom_point(color = "darkorchid4") +
labs(title = "Monthly Closing trend - Communication Services",
subtitle = "The data frame is sent to the plot using pipes",
y = "Closing",
x = "Date") + theme_bw(base_size = 12)
communication_services_month %>%
mutate(month2 = as.Date(paste0("2019-", month,"-01"),"%Y-%m-%d")) %>%
ggplot(aes(x = month2, y = max_mean_close)) +
geom_bar(stat = "identity", fill = "blueviolet") +
facet_wrap(~ year, ncol = 2, as.table=FALSE) +
labs(title = "Total Close Values Per Month - Communication Services",
subtitle = "Bar plots defining the close values for the Communication Services Sector (2019-22)",
y = "Closing Trend",
x = "Month") + theme_bw(base_size = 12) +
scale_x_date(date_labels = "%b")
consumer_discretionary_month %>%
mutate(month2 = as.Date(paste0("2019-", month,"-01"),"%Y-%m-%d")) %>%
ggplot(aes(x = month2, y = max_mean_close)) +
geom_bar(stat = "identity", fill = "blueviolet") +
facet_wrap(~ year, ncol = 2, as.table=FALSE) +
labs(title = "Total Close Values Per Month - Consumer Discretionary",
subtitle = "Bar plots defining the close values for the Consumer Discretinary Sector (2019-22)",
y = "Closing Trend",
x = "Month") + theme_bw(base_size = 12) + theme_bw(base_size = 12) +
scale_x_date(date_labels = "%b")
consumer_staples_month %>%
mutate(month2 = as.Date(paste0("2019-", month,"-01"),"%Y-%m-%d")) %>%
ggplot(aes(x = month2, y = max_mean_close)) +
geom_bar(stat = "identity", fill = "blueviolet") +
facet_wrap(~ year, ncol = 2, as.table=FALSE) +
labs(title = "Total Close Values Per Month - Consumer Staples",
subtitle = "Bar plots defining the close values for the Consumer Staples Sector (2019-22)",
y = "Closing Trend",
x = "Month") + theme_bw(base_size = 12) + theme_bw(base_size = 12) +
scale_x_date(date_labels = "%b")
energy_month %>%
mutate(month2 = as.Date(paste0("2019-", month,"-01"),"%Y-%m-%d")) %>%
ggplot(aes(x = month2, y = max_mean_close)) +
geom_bar(stat = "identity", fill = "blueviolet") +
facet_wrap(~ year, ncol = 2, as.table=FALSE) +
labs(title = "Total Close Values Per Month - Energy",
subtitle = "Bar plots defining the close values for the Energy Sector (2019-22)",
y = "Closing Trend",
x = "Month") + theme_bw(base_size = 12) + theme_bw(base_size = 12) +
scale_x_date(date_labels = "%b")
financials_month %>%
mutate(month2 = as.Date(paste0("2019-", month,"-01"),"%Y-%m-%d")) %>%
ggplot(aes(x = month2, y = max_mean_close)) +
geom_bar(stat = "identity", fill = "blueviolet") +
facet_wrap(~ year, ncol = 2, as.table=FALSE) +
labs(title = "Total Close Values Per Month - Financial",
subtitle = "Bar plots defining the close values for the Financial Sector (2019-22)",
y = "Closing Trend",
x = "Month") + theme_bw(base_size = 12) + theme_bw(base_size = 12) +
scale_x_date(date_labels = "%b")
health_care_month %>%
mutate(month2 = as.Date(paste0("2019-", month,"-01"),"%Y-%m-%d")) %>%
ggplot(aes(x = month2, y = max_mean_close)) +
geom_bar(stat = "identity", fill = "blueviolet") +
facet_wrap(~ year, ncol = 2, as.table=FALSE) +
labs(title = "Total Close Values Per Month - Health Care",
subtitle = "Bar plots defining the close values for the Health Care Sector (2019-22)",
y = "Closing Trend",
x = "Month") + theme_bw(base_size = 12) + theme_bw(base_size = 12) +
scale_x_date(date_labels = "%b")
industrials_month %>%
mutate(month2 = as.Date(paste0("2019-", month,"-01"),"%Y-%m-%d")) %>%
ggplot(aes(x = month2, y = max_mean_close)) +
geom_bar(stat = "identity", fill = "blueviolet") +
facet_wrap(~ year, ncol = 2, as.table=FALSE) +
labs(title = "Total Close Values Per Month - Industrial",
subtitle = "Bar plots defining the close values for the Industrial Sector (2019-22)",
y = "Closing Trend",
x = "Month") + theme_bw(base_size = 12)+ theme_bw(base_size = 12) +
scale_x_date(date_labels = "%b")
Information_Technology_month %>%
mutate(month2 = as.Date(paste0("2019-", month,"-01"),"%Y-%m-%d")) %>%
ggplot(aes(x = month2, y = max_mean_close)) +
geom_bar(stat = "identity", fill = "blueviolet") +
facet_wrap(~ year, ncol = 2, as.table=FALSE) +
labs(title = "Total Close Values Per Month - Information Technology",
subtitle = "Bar plots defining the close values for the Information Technology Sector (2019-22)",
y = "Closing Trend",
x = "Month") + theme_bw(base_size = 12) + theme_bw(base_size = 12) +
scale_x_date(date_labels = "%b")
materials_month %>%
mutate(month2 = as.Date(paste0("2019-", month,"-01"),"%Y-%m-%d")) %>%
ggplot(aes(x = month2, y = max_mean_close)) +
geom_bar(stat = "identity", fill = "blueviolet") +
facet_wrap(~ year, ncol = 2, as.table=FALSE) +
labs(title = "Total Close Values Per Month - Materials",
subtitle = "Bar plots defining the close values for the Material Sector (2019-22)",
y = "Closing Trend",
x = "Month") + theme_bw(base_size = 12) + theme_bw(base_size = 12) +
scale_x_date(date_labels = "%b")
real_estate_month %>%
mutate(month2 = as.Date(paste0("2019-", month,"-01"),"%Y-%m-%d")) %>%
ggplot(aes(x = month2, y = max_mean_close)) +
geom_bar(stat = "identity", fill = "blueviolet") +
facet_wrap(~ year, ncol = 2, as.table=FALSE) +
labs(title = "Total Close Values Per Month - Real Estate",
subtitle = "Bar plots defining the close values for the Real Estate Sector (2019-22)",
y = "Closing Trend",
x = "Month")   + theme_bw(base_size = 12) +
scale_x_date(date_labels = "%b")
utilities_month %>%
mutate(month2 = as.Date(paste0("2019-", month,"-01"),"%Y-%m-%d")) %>%
ggplot(aes(x = month2, y = max_mean_close)) +
geom_bar(stat = "identity", fill = "blueviolet") +
facet_wrap(~ year, ncol = 2, as.table=FALSE) +
labs(title = "Total Close Values Per Month - Utilities",
subtitle = "Bar plots defining the close values for the Utility Sector (2019-22)",
y = "Closing Trend",
x = "Month") + theme_bw(base_size = 12) +
scale_x_date(date_labels = "%b")
combined_sector_data <- read.csv("S&P-500 Sector Combined Data.csv")
combined_sector_data$Date <- as.POSIXct( utilities$Date, format="%Y-%m-%d" )
combined_sector_data <- combined_sector_data %>% mutate(Month=month(Date))
combined_sector_data <- combined_sector_data %>% mutate(Year=year(Date))
combined_sector_data$Year_Month <- as.yearmon(paste(combined_sector_data$Year, combined_sector_data$Month), "%Y %m")
combined_sector_data_2022 = subset(combined_sector_data, subset=combined_sector_data$Date>='2022-01-01' & combined_sector_data$Date<='2022-12-31')
combined_sector_data_2021 = subset(combined_sector_data, subset=combined_sector_data$Date>='2021-01-01' & combined_sector_data$Date<='2021-12-31')
combined_sector_data_2020 = subset(combined_sector_data, subset=combined_sector_data$Date>='2020-01-01' & combined_sector_data$Date<='2020-12-31')
combined_sector_data_2019 = subset(combined_sector_data, subset=combined_sector_data$Date>='2019-01-01' & combined_sector_data$Date<='2019-12-31')
head(combined_sector_data)
sample(combined_sector_data_2019)
tickers = c("Communication Services", "Consumer Discretionary", "Consumer Staples", "Energy", "Financials", "Healthcare", "Industrials", "Information Technology", "Materials", "Real Estate", "Utilities")
fig <- plot_ly(combined_sector_data_2019, type = 'scatter', mode = 'lines')%>%
add_trace(x = ~Date, y = ~CS_High, name = 'Communication Services High')%>%
add_trace(x = ~Date, y = ~CD_High, name = 'Consumer Discretionary High')%>%
add_trace(x = ~Date, y = ~CST_High, name = 'Consumer Staples High')%>%
add_trace(x = ~Date, y = ~E_High, name = 'Energy High')%>%
add_trace(x = ~Date, y = ~F_High, name = 'Financials High')%>%
add_trace(x = ~Date, y = ~HC_High, name = 'Healthcare High')%>%
add_trace(x = ~Date, y = ~I_High, name = 'Industrials High')%>%
add_trace(x = ~Date, y = ~IT_High, name = 'Information Technology High')%>%
add_trace(x = ~Date, y = ~M_High, name = 'Materials High')%>%
add_trace(x = ~Date, y = ~RE_High, name = 'Real Estate High')%>%
add_trace(x = ~Date, y = ~U_High, name = 'Utilities High')%>%
layout()
options(warn = -1)
fig <- fig %>%
layout(
xaxis = list(zerolinecolor = '#ffff',
zerolinewidth = 2,
gridcolor = 'ffff'),
yaxis = list(zerolinecolor = '#ffff',
zerolinewidth = 2,
gridcolor = 'ffff'),
plot_bgcolor='#e5ecf6')
fig <- fig %>% layout(title = "High Trend for all sectors(2019)")
fig
tickers = c("Communication Services", "Consumer Discretionary", "Consumer Staples", "Energy", "Financials", "Healthcare", "Industrials", "Information Technology", "Materials", "Real Estate", "Utilities")
fig <- plot_ly(combined_sector_data_2020, type = 'scatter', mode = 'lines')%>%
add_trace(x = ~Date, y = ~CS_High, name = 'Communication Services High')%>%
add_trace(x = ~Date, y = ~CD_High, name = 'Consumer Discretionary High')%>%
add_trace(x = ~Date, y = ~CST_High, name = 'Consumer Staples High')%>%
add_trace(x = ~Date, y = ~E_High, name = 'Energy High')%>%
add_trace(x = ~Date, y = ~F_High, name = 'Financials High')%>%
add_trace(x = ~Date, y = ~HC_High, name = 'Healthcare High')%>%
add_trace(x = ~Date, y = ~I_High, name = 'Industrials High')%>%
add_trace(x = ~Date, y = ~IT_High, name = 'Information Technology High')%>%
add_trace(x = ~Date, y = ~M_High, name = 'Materials High')%>%
add_trace(x = ~Date, y = ~RE_High, name = 'Real Estate High')%>%
add_trace(x = ~Date, y = ~U_High, name = 'Utilities High')%>%
layout()
options(warn = -1)
fig <- fig %>%
layout(
xaxis = list(zerolinecolor = '#ffff',
zerolinewidth = 2,
gridcolor = 'ffff'),
yaxis = list(zerolinecolor = '#ffff',
zerolinewidth = 2,
gridcolor = 'ffff'),
plot_bgcolor='#e5ecf6')
fig <- fig %>% layout(title = "High Trend for all sectors(2020)")
fig
tickers = c("Communcation Services", "Consumer Discretionary", "Consumer Staples", "Energy", "Financials", "Healthcare", "Industrials", "Information Technology", "Materials", "Real Estate", "Utilities")
fig <- plot_ly(combined_sector_data_2021, type = 'scatter', mode = 'lines')%>%
add_trace(x = ~Date, y = ~CS_High, name = 'Communication Services High')%>%
add_trace(x = ~Date, y = ~CD_High, name = 'Consumer Discretionary High')%>%
add_trace(x = ~Date, y = ~CST_High, name = 'Consumer Staples High')%>%
add_trace(x = ~Date, y = ~E_High, name = 'Energy High')%>%
add_trace(x = ~Date, y = ~F_High, name = 'Financials High')%>%
add_trace(x = ~Date, y = ~HC_High, name = 'Healthcare High')%>%
add_trace(x = ~Date, y = ~I_High, name = 'Industrials High')%>%
add_trace(x = ~Date, y = ~IT_High, name = 'Information Technology High')%>%
add_trace(x = ~Date, y = ~M_High, name = 'Materials High')%>%
add_trace(x = ~Date, y = ~RE_High, name = 'Real Estate High')%>%
add_trace(x = ~Date, y = ~U_High, name = 'Utilities High')%>%
layout()
options(warn = -1)
fig <- fig %>%
layout(
xaxis = list(zerolinecolor = '#ffff',
zerolinewidth = 2,
gridcolor = 'ffff'),
yaxis = list(zerolinecolor = '#ffff',
zerolinewidth = 2,
gridcolor = 'ffff'),
plot_bgcolor='#e5ecf6')
fig <- fig %>% layout(title = "High Trend for all sectors(2021)")
fig
tickers = c("Communication Services", "Consumer Discretionary", "Consumer Staples", "Energy", "Financials", "Healthcare", "Industrials", "Information Technology", "Materials", "Real Estate", "Utilities")
fig <- plot_ly(combined_sector_data_2022, type = 'scatter', mode = 'lines')%>%
add_trace(x = ~Date, y = ~CS_High, name = 'Communication Services High')%>%
add_trace(x = ~Date, y = ~CD_High, name = 'Consumer Discretionary High')%>%
add_trace(x = ~Date, y = ~CST_High, name = 'Consumer Staples High')%>%
add_trace(x = ~Date, y = ~E_High, name = 'Energy High')%>%
add_trace(x = ~Date, y = ~F_High, name = 'Financials High')%>%
add_trace(x = ~Date, y = ~HC_High, name = 'Healthcare High')%>%
add_trace(x = ~Date, y = ~I_High, name = 'Industrials High')%>%
add_trace(x = ~Date, y = ~IT_High, name = 'Information Technology High')%>%
add_trace(x = ~Date, y = ~M_High, name = 'Materials High')%>%
add_trace(x = ~Date, y = ~RE_High, name = 'Real Estate High')%>%
add_trace(x = ~Date, y = ~U_High, name = 'Utilities High')%>%
layout()
options(warn = -1)
fig <- fig %>%
layout(
xaxis = list(zerolinecolor = '#ffff',
zerolinewidth = 2,
gridcolor = 'ffff'),
yaxis = list(zerolinecolor = '#ffff',
zerolinewidth = 2,
gridcolor = 'ffff'),
plot_bgcolor='#e5ecf6')
fig <- fig %>% layout(title = "High Trend for all sectors(2022)")
fig
PFizer <-read.csv("PFE_forecasting.csv" ,header = TRUE,na.strings = 999.99)
head(PFizer)
tail(PFizer)
View(PFizer)
dim(PFizer)
str(PFizer)
PFizer <- PFizer %>% mutate(Date = as.Date(Date, format = "%d/%m/%Y"))
PFizer <- PFizer %>% mutate(month=month(Date))
PFizer <- PFizer %>% mutate(year=year(Date))
head(PFizer)
plot(PFizer$year,PFizer$Close,xlab="Month",ylab="Close",type="l",lwd=2,col="blue")
# plot the data using ggplot2 and pipes
PFizer %>%
ggplot(aes(x = Date, y = Close)) +
geom_point(color = "darkorchid4") +
labs(title = "Closing trend - PFizer",
subtitle = "The data frame is sent to the plot using pipes",
y = "Closing trend",
x = "Date") + theme_bw(base_size = 15)
plot(10*diff(log(PFizer[,6])),xlab="year",ylab="Close",type="l",lwd=2,col="orange")
year_data_PFizer=subset(PFizer,subset=PFizer$Date>='2022-01-01' & PFizer$Date<='2022-12-31')
head(year_data_PFizer)
plot(year_data_PFizer[,1],year_data_PFizer[,6],xlab="Year 2022",ylab="Close",type="l",lwd=2,main="Close values",col="orange")
quantile(PFizer$Close,probs=c(0,0.25,0.5,0.75,1))
PFizer$Date <- as.POSIXct( PFizer$Date, format="%Y-%m-%d" )
PFizer <- PFizer %>% mutate(month=month(Date))
PFizer <- PFizer %>% mutate(year=year(Date))
PFizer_month <- PFizer %>% group_by(month, year) %>% summarise(Close = sum(Close))
PFizer_2019 = subset(PFizer, subset=PFizer$Date>='2019-01-01' & PFizer$Date<='2019-12-31')
PFizer_2020 = subset(PFizer, subset=PFizer$Date>='2020-01-01' & PFizer$Date<='2020-12-31')
PFizer_2021 = subset(PFizer, subset=PFizer$Date>='2021-01-01' & PFizer$Date<='2021-12-31')
PFizer_2022 = subset(PFizer, subset=PFizer$Date>='2022-01-01' & PFizer$Date<='2022-12-31')
#boxplot(PFizer$Close~PFizer$year,main="Closing trend over the years 2019-2022",ylab="Closing",xlab="years",las=1,col="green")
ggplot(data=PFizer, aes(group = 1, x = year)) +
geom_boxplot(linetype = "solid", size = 1, data=PFizer_2019, aes(y=Close), color='steelblue') +
geom_boxplot(linetype = "solid", size = 1, data=PFizer_2020, aes(y=Close), color='coral2') +
geom_boxplot(linetype = "solid", size = 1, data=PFizer_2021, aes(y=Close), color='darkorchid') +
geom_boxplot(linetype = "solid", size = 1, data=PFizer_2022, aes(y=Close), color='darkorange')  + theme_minimal(base_size = 12) + labs(title = " Close Trend (normalised) - PFizer ", subtitle = "A box plot defining the close values for the PFizer (2019-22)", y = "Close Trend", x = "Date")
ggplot(data = PFizer, aes(x = Date)) +
geom_line(linetype = "solid", size = 1, data=PFizer_2019, aes(y=High), color='steelblue') +
geom_line(linetype = "solid", size = 1, data=PFizer_2020, aes(y=High), color='coral2') +
geom_line(linetype = "solid", size = 1, data=PFizer_2021, aes(y=High), color='darkorchid') +
geom_line(linetype = "solid", size = 1, data=PFizer_2022, aes(y=High), color='darkorange')  + theme_minimal(base_size = 12) +  labs(title = " High Trend (normalised) - Fizer", subtitle = "A line plot defining the high values for Fizer (2019-22)", y = "High Trend", x = "Date")
ggplot(data=PFizer) +
geom_line(linetype = "solid", size = 1, aes(x=Date, y=High), color='darkorchid') +
geom_line(linetype = "solid", size = 1, aes(x=Date, y=Low), color='darkorange')  + theme_minimal(base_size = 12) +
labs(title = "High and Low Trend - Fizer", subtitle = "A line plot defining the high and low values for Fizer (2019-22)", y = "High (Purple) and Low (Orange) Trend", x = "Date")
PFizer %>%
mutate(month = as.Date(paste0("2019-", month,"-01"),"%Y-%m-%d")) %>%
ggplot(aes(x = month, y = Close)) +
geom_bar(stat = "identity", fill = "blueviolet") +
facet_wrap(~ year, ncol = 2, as.table=FALSE) +
labs(title = "Total Close Values Per Month - Fizer",
subtitle = "Bar plots defining the close values for Fizer (2019-22)",
y = "Closing Trend",
x = "Month") + theme_bw(base_size = 12) +
scale_x_date(date_labels = "%b")
# plot the data using ggplot2 and pipes
PFizer %>%
ggplot(aes(x = month, y = Close)) +
geom_point(color = "darkorchid4") +
labs(title = "Monthly Closing trend - PFizer",
subtitle = "The data frame is sent to the plot using pipes",
y = "Closing",
x = "Date") + theme_bw(base_size = 15)
ggplot(data=PFizer,aes(x=month,y=Close,col="red",group=1))+geom_line(linetype="dashed")+geom_point()
# calculate the sum closing for each month
PFizer_month <- PFizer %>%
group_by(month, year) %>%
summarise(max_Close = sum(Close))
head(PFizer_month)
PFizer_month %>%
mutate(month2 = as.Date(paste0("2019-", month,"-01"),"%Y-%m-%d")) %>%
ggplot(aes(x = month2, y = max_Close)) +
geom_bar(stat = "identity", fill = "darkorchid4") +
facet_wrap(~ year, ncol = 3) +
labs(title = "Monthly Total Daily closing",
subtitle = "Data plotted by year",
y = "Closing trend",
x = "Month") + theme_bw(base_size = 15) +
scale_x_date(date_labels = "%b")
PFizer %>% select(Date,Close)
class(PFizer)
PFizer_time <-ts(PFizer$Close,start=min(PFizer$Date),end=max(PFizer$Date),frequency = 1)
class(PFizer_time)
plot(PFizer_time)
acf(PFizer_time)
